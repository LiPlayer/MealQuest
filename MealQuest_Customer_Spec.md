# 餐餐有戏 顾客端产品全景需求文档 (Master Customer Spec V1.1)

> **项目名称**：餐餐有戏 (MealQuest)
> **核心定义**：基于“资产包”逻辑的单页式餐饮应用。
> **文档目标**：本文档描述了产品的**页面层级结构 (Page Hierarchy)** 及**页面详细布局 (Page Layouts)**，明确所有功能的入口路径。

## 第一章：页面层级结构 (Page Hierarchy)

本系统采用“单页应用 (SPA)” 架构，无传统 TabBar。所有核心入口折叠于首页。

*   **L0. 启动层**
    *   `Launch` 启动页 / 登录 Landing
    *   **[外部扫码]** (仅限微信/App内扫一扫，**不支持系统相机**) $\rightarrow$ 直达 **[P15 双模收银台]** (带入商家信息)
*   **L1. 首页核心容器 (P00 Home)**
    *   **顶部导航 (Top Nav)**
        *   `Avatar` 头像 $\rightarrow$ **[P20 个人中心]**
        *   `Bell` 消息 $\rightarrow$ **[P21 消息通知]**
    *   **店铺招牌 (Merchant Banner)**
        *   展示：商户 Logo、名称、Slogan、营业状态
    *   **卡片堆叠区 (Card Stack)**
        *   **[A] 碎银卡 (Silver)** (常驻显示：余额 & **今日步数**) $\xrightarrow{展开}$ **[P01 碎银详情页]**
            *   $\rightarrow$ **[P10 碎银集市]** (点击“逛集市”)
            *   $\rightarrow$ **[P11 游戏中心]** (点击“玩游戏”)
        *   **[B] 储值卡 (Balance)** $\xrightarrow{展开}$ **[P02 储值详情页]**
            *   $\rightarrow$ **[P12 充值中心]** (点击 Banner)
            *   $\rightarrow$ **[P13 账单明细]** (点击“查看账单”)
        *   **[C] 入席令卡 (Orders)** $\xrightarrow{展开}$ **[P03 入席令列表页]**
            *   $\rightarrow$ **[P14 入席令详情/核销]** (点击卡片)
        *   **[D] 碎片卡 (Fragments)** $\xrightarrow{展开}$ **[P04 碎片合成台]**
            *   $\rightarrow$ **[P10 碎银集市]** (点击缺口/去获取)
    *   **底部支付坞 (Payment Dock)**
        *   `Dock` 支付按钮 $\rightarrow$ **[P15 双模收银台]**

---

## 第二章：首页与核心容器 (P00 Home)

### 2.1 整体布局
首页是所有功能的容器，由背景、顶部导航、中部卡片堆叠区、底部支付坞组成。

| 区域 | 元素 | 描述与交互 |
| :--- | :--- | :--- |
| **Top Nav** | **左上头像** | 显示用户圆形头像。点击 $\rightarrow$ **[P20 个人中心]**。 |
| | **右上铃铛** | 显示消息图标及红点。点击 $\rightarrow$ **[P21 消息通知]**。 |
| **Header** | **店铺招牌** | **定位**：Top Nav 下方，卡片上方。<br>**内容**：<br>1. 商户 Logo (圆形/方形)。<br>2. 商户名称 (大号加粗，如“有戏小馆”)。<br>3. 品牌 Slogan (如“好戏在后头”)。<br>4. 营业状态标签 (营业中/休息中)。 |
| **Body** | **卡片堆叠组** | 包含 4 张卡片 (Silver, Balance, Orders, Fragments)。<br>初始状态为**折叠态**，每张卡片露出顶部 **75px** 标题区。 |
| **Bottom** | **支付坞** | 悬浮于底部的黑色胶囊条 (Bottom: 32px)。<br>点击 $\rightarrow$ **[P15 收银台]**。 |

### 2.2 核心交互：堆叠与展开
*   **展开逻辑**：点击任意折叠卡片的标题区 $\rightarrow$ 该卡片弹射展开至顶部 (Top: 100px)，其余卡片下沉隐藏。
*   **折叠逻辑**：在展开态下，点击卡片标题区或背景空白处 $\rightarrow$ 所有卡片恢复折叠堆叠态。
*   **互斥性**：同一时间只能展开一张卡片。

---

## 第三章：核心卡片详情页 (Card Details)

### P01. 碎银详情页 (Silver Card Expanded)
*   **入口**：首页点击 `SILVER` 卡片均可进入。
*   **功能**：展示通用货币状态，提供获取途径入口。

#### 3.1 布局规范 (Layout)
1.  **Header (摘要区 / 折叠态可见)**:
    *   左侧：标签 `SILVER`。
    *   **中间 (新增)**：**步数胶囊** (半透明背景 `bg-black/10`)，显示 `👣 8,420` (实时同步)。
    *   右侧：数值 `12,850 两` (大号字体)。
2.  **Action Grid (功能入口)**:
    *   **[逛集市] 按钮**：
        *   图标：灯笼 🏮。
        *   文案：“采购/出售碎片”。
        *   交互：点击 $\rightarrow$ 跳转 **[P10 碎银集市]**。
    *   **[玩游戏] 按钮**：
        *   图标：手柄 🎮。
        *   文案：“赢取积分 (今日剩余3次)”。
        *   交互：点击 $\rightarrow$ 跳转 **[P11 游戏中心]**。
3.  **Step Mining (步数挖矿 / 原健康组件)**:
    *   **视觉融入**：不再是独立组件，而是作为碎银的一级产出源。
    *   **交互设计**：
        *   **未达标**：展示为一个**正在充能的电池/圆环**，文案“步行产出中... (8420/10000)”。
        *   **已达标**：变为**高亮的 [收银] 按钮** (类似蚂蚁森林)，点击触发碎银飞入钱包的动效。
4.  **Mini Log (近期流水)**:
    *   列表展示最近 3 条碎银变动记录（仅摘要）。

---

### P02. 储值详情页 (Balance Card Expanded)
*   **入口**：首页点击 `BALANCE` 卡片进入。
*   **功能**：展示真金白银资产，提供充值入口。

#### 3.2 布局规范 (Layout)
1.  **Header (摘要区)**:
    *   左侧标签 `BALANCE`。
    *   右侧数值 `¥120.00`。
2.  **Chart Area (资金双柱图)**:
    *   **本金柱 (Principal)**：白色，标注“可退款”。显示金额 (¥100)。
    *   **赠送柱 (Gift)**：金色，标注“活动金”。显示金额 (¥20)。
    *   *注：直观展示资金构成，建立安全感。*
3.  **Promo Banner (充值入口)**:
    *   样式：横幅广告位，色彩鲜艳 (Pink/Rose)。
    *   内容：“首充大礼 | 充 ¥200 送 ¥20”。
    *   交互：点击 $\rightarrow$ 跳转 **[P12 充值中心]**。
4.  **Footer Action**:
    *   全宽按钮 **[查看账单明细]** (以票据图标 🧾 示意)。
    *   交互：点击 $\rightarrow$ 跳转 **[P13 账单明细]**。

---

### P03. 入席令列表页 (Orders Card Expanded)
*   **入口**：首页点击 `ORDERS` 卡片进入。
*   **功能**：管理和使用已合成的兑换券。

#### 3.3 布局规范 (Layout)
1.  **Header (摘要区)**:
    *   左侧标签 `ORDERS`。
    *   右侧胶囊 `2 张可用`。
2.  **Filter Tabs (筛选)**:
    *   `可用` (默认选中) | `历史` (已核销/已过期)。
3.  **Ticket List (票券列表)**:
    *   垂直滚动列表。
    *   **单张票券样式**：
        *   左侧：菜品图片 + 名称 (如“招牌酱鸡”) + 有效期。
        *   右侧：**[去使用]** 按钮模拟撕票口。
        *   标签：`GOLD` (硬菜) 或 `SILVER` (小食)，背景色不同。
    *   交互：点击任意票券 $\rightarrow$ 跳转 **[P14 入席令详情]**。

---

### P04. 碎片合成台 (Fragments Card Expanded)
*   **入口**：首页点击 `FRAGMENTS` 卡片进入。
*   **功能**：查看收集进度，合成入席令。

#### 3.4 布局规范 (Layout)
1.  **Header (摘要区)**:
    *   左侧标签 `FRAGMENTS`。
    *   右侧进度 `3/5`。
2.  **Recipe Switcher (食谱切换器)**:
    *   顶部展示当前目标菜品：“正在研制：招牌酱汁鸡腿”。
    *   左右箭头 `< >` 切换不同目标菜品。
3.  **Crafting Slots (九宫格槽位)**:
    *   3x3 网格布局。
    *   **状态 A (已拥有)**：显示高清食材 icon，右下角 `x2` 数量标。
    *   **状态 B (未拥有)**：虚线框 + 灰色剪影。
        *   交互：点击缺失槽位 $\rightarrow$ 弹窗提示“去集市寻找？” $\rightarrow$ 跳转 **[P10 碎银集市]**。
4.  **Craft Button (合成按钮)**:
    *   状态：
        *   *未集齐*：灰色不可点，文案“还差 2 种食材”。
        *   *已集齐*：流光特效按钮 **[立即合成]** $\rightarrow$ 触发合成动画，获得入席令。

---

## 第四章：功能子页面 (Functional Sub-Pages)

### P10. 碎银集市 (Marketplace)
*   **入口**：P01 点击 [逛集市]；P04 点击 [缺失槽位]。
*   **布局**：
    *   **顶栏**：Tab 切换 `采购 (Buy)` | `当铺 (Sell)`。
    *   **采购页**：
        *   **每日特惠**：展示 3 个随机普通碎片 (价格低，用碎银买)。
        *   **稀有黑市**：展示 1 个稀有碎片 (价格高，库存少)。
    *   **当铺页**：
        *   网格展示背包中所有碎片。选中后显示回收价，点击 **[出售]** 换取碎银。

### P11. 游戏中心 (Game Center)
*   **入口**：P01 点击 [玩游戏]。
*   **布局**：
    *   **封面区**：当前主推游戏《神厨飞刀》海报。
    *   **开始按钮**：巨大的 **[PLAY]** 按钮。
    *   **结算页**：游戏结束后弹出，展示 `本局得分` 及 `获得碎银` (分数/100)。

### P12. 充值中心 (Top-up Center)
*   **入口**：P02 点击 Banner。
*   **布局**：
    *   **SKU 网格**：如 `¥50`, `¥100`, `¥200 (热)`。
        *   每个卡片明确标注：实付 ¥200，到账 ¥220 (含 ¥20 赠送)。
    *   **协议区**：底部固定。必须勾选 *“我已知晓退款时将扣除已消费的赠送金权益”*。
    *   **支付按钮**：微信/支付宝唤起。

### P13. 账单明细 (Transaction History)
*   **入口**：P02 点击 [查看账单]。
*   **布局**：
    *   无限滚动列表。
    *   每行：左侧 (类型图标+时间)，右侧 (变动金额，绿进黑出)。
    *   类型涵盖：充值、消费、退款、游戏奖励、集市交易。

### P14. 入席令详情 (Order Detail)
*   **入口**：P03 点击具体票券。
*   **布局**：
    *   **拟真卡片**：屏幕中央展示一张精美的 3D 菜品卡片。
    *   **翻转交互**：点击卡片翻转至背面。
    *   **背面内容**：
        *   核销二维码 (QR Code)。
        *   核销码字符串 (Code 128)。
    *   **底部操作**：
        *   **[赠送给好友]**：调用微信分享接口。
        *   **[保存到相册]**。

### P15. 双模收银台 (Cashier)
*   **入口**：
    1.  首页底部支付坞 (点击即唤起)。
    2.  微信/App直接扫商家码 (外部入口)。
*   **布局与交互**：
    *   **进入逻辑**：
        *   **若直接扫码进入**：自动锁定[当前商家] 与 [桌号] (若有)，直接展示金额输入键盘。
        *   **若支付坞进入**：默认展示上次使用的模式或[扫码付款]页。
    *   **模式 A (扫码付款)**：
        *   显示当前商家名称。
        *   数字键盘区域。
        *   输入金额后，显示 **[确认支付]**。系统自动计算最优抵扣方案。
    *   **模式 B (会员码/被扫)**：
        *   显示动态条形码/二维码。
        *   下方列表展示：当前可用余额、可用入席令（供商家扫码枪读取）。

### P20. 个人中心 (Profile)
*   **入口**：首页左上角头像。
*   **布局**：
    *   **用户信息**：头像、昵称、UID。
    *   **数据概览**：累计消费、加入天数。
    *   **荣誉墙**：展示获得的勋章 (Badges)。
    *   **设置列表**：关于我们、退出登录。

---

## 第五章：全局组件 (Global Components)

### 5.1 Toast 与 弹窗
*   **获得资产**：使用全屏覆盖层 (Overlay)，播放粒子特效，展示获得的物品与光效。
*   **错误提示**：顶部下拉 Toast (如“余额不足”)。

### 5.2 状态同步
*   **WebSocket**：所有页面需监听资产变动消息。
    *   例：在 [P10 集市] 购买碎片后，返回 [P04 碎片页]，碎银数值与碎片数量应当即刷新，无延迟。
